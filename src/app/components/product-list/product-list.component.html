<div class="product-list-container">
  
  <!-- Header -->
  @if (title || showSearch) {
    <div class="product-list-header">
      @if (title) {
        <h2 class="product-list-title">{{ title }}</h2>
      }
      
      @if (showSearch) {
        <div class="product-list-search">
          <input 
            type="text"
            class="search-input"
            placeholder="Buscar productos..."
            [(ngModel)]="searchTerm"
            (input)="onSearch($event)">
          <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24">
            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="currentColor"/>
          </svg>
        </div>
      }
    </div>
  }

  <!-- Loading state -->
  @if (loading) {
    <div class="product-list-loading">
      <div class="loading-spinner"></div>
      <p>Cargando productos...</p>
    </div>
  }

  <!-- Product grid -->
  @if (!loading && filteredProducts.length > 0) {
    <div 
      class="product-grid" 
      [class]="'product-grid-' + columns">
      
      @for (product of filteredProducts; track product.id || $index) {
        <div 
          class="product-card"
          [class.product-featured]="product.featured"
          (click)="onProductClick(product)">
          
          <!-- Product image -->
          <div class="product-image">
            <img 
              [src]="product.image || '/assets/placeholder.jpg'" 
              [alt]="product.name"
              (error)="onImageError($event)">
            
            @if (product.badges?.length) {
              <div class="product-badges">
                @for (badge of product.badges; track badge.id || $index) {
                  <span 
                    [class]="'product-badge product-badge-' + badge.type">
                    {{ badge.text }}
                  </span>
                }
              </div>
            }
          </div>
          
          <!-- Product info -->
          <div class="product-info">
            <h3 class="product-name">{{ product.name }}</h3>
            @if (product.description) {
              <p class="product-description">
                {{ product.description }}
              </p>
            }
            
            <div class="product-price">
              <span class="price-current">{{ product.price | currency }}</span>
              @if (product.originalPrice && product.originalPrice > product.price) {
                <span class="price-original">
                  {{ product.originalPrice | currency }}
                </span>
              }
            </div>
            
            @if (product.rating) {
              <div class="product-rating">
                <div class="rating-stars">
                  @for (star of [1,2,3,4,5]; track star) {
                    <span 
                      class="star"
                      [class.star-filled]="star <= product.rating">
                      ★
                    </span>
                  }
                </div>
                @if (product.reviewCount) {
                  <span class="rating-count">
                    ({{ product.reviewCount }})
                  </span>
                }
              </div>
            }
          </div>
          
          <!-- Product actions -->
          <div class="product-actions">
            <button 
              class="btn-add-cart"
              (click)="onAddToCart(product); $event.stopPropagation()">
              Añadir al carrito
            </button>
            
            <button 
              class="btn-favorite"
              [class.btn-favorite-active]="product.isFavorite"
              (click)="onToggleFavorite(product); $event.stopPropagation()">
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="currentColor"/>
              </svg>
            </button>
          </div>
        </div>
      }
    </div>
  }

  <!-- Empty state -->
  @if (!loading && filteredProducts.length === 0) {
    <div class="product-list-empty">
      <svg class="empty-icon" width="64" height="64" viewBox="0 0 24 24">
        <path d="M7 4V2C7 1.45 7.45 1 8 1H16C16.55 1 17 1.45 17 2V4H20C20.55 4 21 4.45 21 5S20.55 6 20 6H19V19C19 20.1 18.1 21 17 21H7C5.9 21 5 20.1 5 19V6H4C3.45 6 3 5.55 3 5S3.45 4 4 4H7ZM9 3V4H15V3H9ZM7 6V19H17V6H7Z" fill="currentColor"/>
      </svg>
      <h3>No se encontraron productos</h3>
      <p>Intenta ajustar los filtros de búsqueda</p>
    </div>
  }

  <!-- Pagination -->
  @if (showPagination && totalPages > 1) {
    <div class="product-pagination">
      <button 
        class="pagination-btn"
        [disabled]="currentPage === 1"
        (click)="onPageChange(currentPage - 1)">
        Anterior
      </button>
      
      <span class="pagination-info">
        Página {{ currentPage }} de {{ totalPages }}
      </span>
      
      <button 
        class="pagination-btn"
        [disabled]="currentPage === totalPages"
        (click)="onPageChange(currentPage + 1)">
        Siguiente
      </button>
    </div>
  }
</div>